\input{include/power-model.tex}

\input{include/thermal-model.tex}

\slabel{analytical-solution}
The thermal model above is expensive as it involves a system of nonlinear differential equations (see \eref{heat-de}), which should be solved numerically using, \eg, Runge-Kutta methods \cite{press2007}. In order to mitigate these computations, we utilize the approach discussed in \cite{ukhov2012}.
The idea is that, if the power term on the right-hand side of \eref{heat-de} stays constant, the system becomes linear and obtains an analytical solution. When the simulated time interval was short enough, the technique was found to have a negligibly small influence on the resulting accuracy; however, the speedup was found to be considerable.
Since $\profilePdyn$ is fine-grained, we can assume that the total power changes only at the time moments $\t_i \in \partition{\mP}$ (see \sref{problem-formulation}). In this way, we can stride in time solving \eref{heat-de} for each step analytically and, thus, gaining a significant speedup.

Now we apply the derivation above to evaluate $\nrdies$ temperature profiles at the spatial locations of the measurements in $\Data$, \ie, at $\{ \r_i \}_{i = 1}^\nrdies$. The resulting temperature profiles are then shrunk to keep data only for those processing elements and only for those moments of time that are present in the measured temperature profiles, \ie, we keep data only for $\nrprocs$ (out of $\nprocs$) processing elements and only for $\nrsteps$ (out of $\nsteps$) moments of time (see \fref{wafer-measured}). Finally, the trimmed profiles are stacked into one vector with $\nrdies \nrprocs \nrsteps$ elements. With a slight abuse of notation, this vector is denoted by $\mvT$ and the overall procedure by $\model$, which we refer to as the forward model (see \fref{algorithm}):
\begin{equation} \elabel{model}
  \mvT = \model{\u}.
\end{equation}
Also, let $\mvT_\meas \in \real^{\nrdies \nrprocs \nrsteps}$ be the stacked version of the measurements in $\Data$, preserving the one-to-one spatial correspondence between the respective elements of $\mvT$ and $\mvT_\meas$.
